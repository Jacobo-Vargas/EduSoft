<section class="vh-100 image-background">
  <div class="container py-5 h-100">
    <div class="row justify-content-center align-items-center h-100">
      <div class="col-12 col-md-10 col-lg-8">
        <div class="card shadow" style="border-radius: 1rem;">
          <div class="card-body p-4 p-lg-5 text-black">

            <!-- Bot√≥n atr√°s -->
            <button type="button" class="person me-2" (click)="goBack()">
              <i class="bi bi-arrow-left"></i>
            </button>

            <!-- Formulario cambiar contrase√±a -->
            <form [formGroup]="userForm" (ngSubmit)="onSubmit()" class="w-100">

              <!-- T√≠tulo -->
              <div class="text-center mb-4">
                <span class="h1 fw-bold">Cambiar contrase√±a</span>
                <h5 class="fw-normal mt-2" style="letter-spacing: 1px;">
                  La contrase√±a debe tener al menos 8 caracteres, incluyendo may√∫scula, min√∫scula, n√∫mero y car√°cter especial
                </h5>
              </div>

              <!-- Alertas -->
              <div *ngIf="errorMsg" class="alert alert-danger mb-3">{{ errorMsg }}</div>
              <div *ngIf="showSuccessMessage" class="alert alert-success mb-3">
                ‚úÖ La contrase√±a se ha modificado correctamente
              </div>

              <!-- Nueva contrase√±a -->
              <div class="mb-3">
                <div class="position-relative">
                  <input id="Password1" [type]="showPassword1 ? 'text' : 'password'" class="form-control form-control-lg pe-5"
                    formControlName="Password1" placeholder="Nueva contrase√±a *"
                    [class.is-invalid]="f['Password1']?.touched && f['Password1']?.invalid" />
                  <span class="eye-icon position-absolute top-50 end-0 translate-middle-y me-3"
                    (click)="togglePassword1()" style="cursor:pointer;">
                    {{ showPassword1 ? 'üôà' : 'üëÅÔ∏è' }}
                  </span>
                </div>

                <div class="invalid-feedback d-block" *ngIf="f['Password1']?.errors?.['required']">
                  La contrase√±a es obligatoria.
                </div>
                <div class="invalid-feedback d-block" *ngIf="f['Password1']?.errors?.['minlength']">
                  Debe tener m√≠nimo 8 caracteres.
                </div>
                <div class="invalid-feedback d-block" *ngIf="f['Password1']?.errors?.['pattern']">
                  Debe contener al menos una may√∫scula, una min√∫scula, un n√∫mero y un car√°cter especial.
                </div>
              </div>

              <!-- Confirmar contrase√±a -->
              <div class="mb-3">
                <div class="position-relative">
                  <input id="Password2" [type]="showPassword2 ? 'text' : 'password'" class="form-control form-control-lg pe-5"
                    formControlName="Password2" placeholder="Confirmar contrase√±a *"
                    [class.is-invalid]="f['Password2']?.touched && f['Password2']?.invalid" />
                  <span class="eye-icon position-absolute top-50 end-0 translate-middle-y me-3"
                    (click)="togglePassword2()" style="cursor:pointer;">
                    {{ showPassword2 ? 'üôà' : 'üëÅÔ∏è' }}
                  </span>
                </div>

                <div class="invalid-feedback d-block" *ngIf="f['Password2']?.errors?.['required']">
                  Confirmar la contrase√±a es obligatorio.
                </div>
                <div class="invalid-feedback d-block" *ngIf="f['Password2']?.errors?.['mismatch']">
                  Las contrase√±as no coinciden.
                </div>
              </div>

              <!-- Botones -->
              <div class="pt-1 mb-3 d-flex justify-content-center">
                <button type="button" class="btn btn-outline-secondary me-2 w-25" (click)="onReset()" [disabled]="isLoading">
                  Limpiar
                </button>

                <button type="submit" class="btn btn-success w-50" [disabled]="isLoading || userForm.invalid">
                  <span *ngIf="isLoading" class="spinner-border spinner-border-sm me-2" role="status"
                    aria-hidden="true"></span>
                  Cambiar contrase√±a
                </button>
              </div>

            </form>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>
